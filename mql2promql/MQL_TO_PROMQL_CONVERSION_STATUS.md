# MQL to PromQL Conversion Guide

This document lists Monitoring Query Language (MQL) queries found in the original [Alerts](../alerts/) and [Dashboards](../dashboards/) repositories and provides status on the translations to Prometheus Query Language (PromQL).

## Summary of Files Containing MQL Queries

| Original File Path                                                                                       | Contains MQL? | Notes                                                                 | Conversion Status | Converted File                                                                                                                                                             | Conversion Documentation                                                                                                 |
| :------------------------------------------------------------------------------------------------------- | :------------ | :-------------------------------------------------------------------- | :---------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------- |
| `dashboards/gdc-daily-report.json`                                                                       | Yes (Partial) | Mixed MQL (`timeSeriesQueryLanguage`) and PromQL (`prometheusQuery`). | To be verified    | [mql2promql/dashboards-promql/gdc-daily-report-promql.json](./dashboards-promql/gdc-daily-report-promql.json) | [mql2promql/docs/dashboards/gdc-daily-report-promql-doc.md](./docs/dashboards/gdc-daily-report-promql-doc.md)     |
| `dashboards/gdc-external-secrets.json`                                                                   | No            | Uses `prometheusQuery`.                                               | N/A               | N/A                                                                                                                                                                        |                                                                                                                          |
| `dashboards/gdc-logs.json`                                                                               | No            | Log panel filters, not metric queries.                                | N/A               | N/A                                                                                                                                                                        |                                                                                                                          |
| `dashboards/gdc-node-view.json`                                                                          | Yes           | Uses `timeSeriesQueryLanguage`.                                       | WIP               | [mql2promql/dashboards-promql/gdc-node-view-promql.json](./dashboards-promql/gdc-node-view-promql.json)       | [mql2promql/docs/dashboards/gdc-node-view-promql-doc.md](./docs/dashboards/gdc-node-view-promql-doc.md)         |
| `dashboards/gdc-robin-status.json`                                                                       | Yes (Partial) | Mixed MQL (`timeSeriesFilter` with MQL-like filter) and PromQL.     | WIP               | [mql2promql/dashboards-promql/gdc-robin-status-promql.json](./dashboards-promql/gdc-robin-status-promql.json) | [mql2promql/docs/dashboards/gdc-robin-status-promql-doc.md](./docs/dashboards/gdc-robin-status-promql-doc.md)   |
| `dashboards/gdc-vm-distribution.json`                                                                    | Yes           | Uses `timeSeriesQueryLanguage`.                                       | To be verified    | [mql2promql/dashboards-promql/gdc-vm-distribution-promql.json](./dashboards-promql/gdc-vm-distribution-promql.json) | [mql2promql/docs/dashboards/gdc-vm-distribution-promql-doc.md](./docs/dashboards/gdc-vm-distribution-promql-doc.md) |
| `dashboards/gdc-vm-view.json`                                                                            | Yes (Partial) | Mixed MQL (`timeSeriesQueryLanguage`, `timeSeriesFilter`) and PromQL. | To be verified    | [mql2promql/dashboards-promql/gdc-vm-view-promql.json](./dashboards-promql/gdc-vm-view-promql.json)             | [mql2promql/docs/dashboards/gdc-vm-view-promql-doc.md](./docs/dashboards/gdc-vm-view-promql-doc.md)         |
| `alerts/control-plane/api-server-error-ratio-5-percent.yaml`                                             | Yes           | `conditionMonitoringQueryLanguage` used.                              | To be verified    | [mql2promql/alerts-promql/control-plane/api-server-error-ratio-5-percent-promql.yaml](./alerts-promql/control-plane/api-server-error-ratio-5-percent-promql.yaml) | [mql2promql/docs/alerts/control-plane/api-server-error-ratio-5-percent-promql-doc.md](./docs/alerts/control-plane/api-server-error-ratio-5-percent-promql-doc.md) |
| `alerts/control-plane/apiserver-down.yaml`                                                               | Yes           | `conditionMonitoringQueryLanguage` used.                              | To be verified    | [mql2promql/alerts-promql/control-plane/apiserver-down-promql.yaml](./alerts-promql/control-plane/apiserver-down-promql.yaml) | [mql2promql/docs/alerts/control-plane/apiserver-down-promql-doc.md](./docs/alerts/control-plane/apiserver-down-promql-doc.md) |
| `alerts/control-plane/controller-manager-down.yaml`                                                      | Yes           | `conditionMonitoringQueryLanguage` used.                              | To be verified    | [mql2promql/alerts-promql/control-plane/controller-manager-down-promql.yaml](./alerts-promql/control-plane/controller-manager-down-promql.yaml) | [mql2promql/docs/alerts/control-plane/controller-manager-down-promql-doc.md](./docs/alerts/control-plane/controller-manager-down-promql-doc.md) |
| `alerts/control-plane/scheduler-down.yaml`                                                               | Yes           | `conditionMonitoringQueryLanguage` used.                              | To be verified    | [mql2promql/alerts-promql/control-plane/scheduler-down-promql.yaml](./alerts-promql/control-plane/scheduler-down-promql.yaml) | [mql2promql/docs/alerts/control-plane/scheduler-down-promql-doc.md](./docs/alerts/control-plane/scheduler-down-promql-doc.md) |
| `alerts/node/multiple-nodes-not-ready-realtime.yaml`                                                     | Yes           | `conditionMonitoringQueryLanguage` used.                              | To be verified    | [mql2promql/alerts-promql/node/multiple-nodes-not-ready-realtime-promql.yaml](./alerts-promql/node/multiple-nodes-not-ready-realtime-promql.yaml) | [mql2promql/docs/alerts/node/multiple-nodes-not-ready-realtime-promql-doc.md](./docs/alerts/node/multiple-nodes-not-ready-realtime-promql-doc.md) |
| `alerts/node/node-cpu-usage-high.yaml`                                                     | Yes           | `conditionMonitoringQueryLanguage` used.                              | To be verified    | [mql2promql/alerts-promql/node/node-cpu-usage-high-promql.yaml](./alerts-promql/node/node-cpu-usage-high-promql.yaml) | [mql2promql/docs/alerts/node/node-cpu-usage-high-promql-doc.md](./docs/alerts/node/node-cpu-usage-high-promql-doc.md) |
| `alerts/node/node-memory-usage-high.yaml`                                                | Yes           | `conditionMonitoringQueryLanguage` used.                              | To be verified    | [mql2promql/alerts-promql/node/node-memory-usage-high-promql.yaml](./alerts-promql/node/node-memory-usage-high-promql.yaml) | [mql2promql/docs/alerts/node/node-memory-usage-high-promql-doc.md](./docs/alerts/node/node-memory-usage-high-promql-doc.md) |
| `alerts/node/node-not-ready-30m.yaml`                                                    | Yes           | `conditionMonitoringQueryLanguage` used.                              | To be verified    | [mql2promql/alerts-promql/node/node-not-ready-30m-promql.yaml](./alerts-promql/node/node-not-ready-30m-promql.yaml) | [mql2promql/docs/alerts/node/node-not-ready-30m-promql-doc.md](./docs/alerts/node/node-not-ready-30m-promql-doc.md) |
| `alerts/pods/pod-crash-looping.yaml`                                                     | Yes           | `conditionMonitoringQueryLanguage` used.                              | To be verified    | [mql2promql/alerts-promql/pods/pod-crash-looping-promql.yaml](./alerts-promql/pods/pod-crash-looping-promql.yaml) | [mql2promql/docs/alerts/pods/pod-crash-looping-promql-doc.md](./docs/alerts/pods/pod-crash-looping-promql-doc.md) |
| `alerts/pods/pod-not-ready-1h.yaml`                                                                      | Yes           | `conditionMonitoringQueryLanguage` used.                              | To be verified    | [mql2promql/alerts-promql/pods/pod-not-ready-1h-promql.yaml](./alerts-promql/pods/pod-not-ready-1h-promql.yaml) | [mql2promql/docs/alerts/pods/pod-not-ready-1h-promql-doc.md](./docs/alerts/pods/pod-not-ready-1h-promql-doc.md) |
| `alerts/storage/robin-disk-inactive-10m.yaml` | Yes | `conditionMonitoringQueryLanguage` used. | WIP | [mql2promql/alerts-promql/storage/robin-disk-inactive-10m-promql.yaml](./alerts-promql/storage/robin-disk-inactive-10m-promql.yaml) | [mql2promql/docs/alerts/storage/robin-disk-inactive-10m-promql-doc.md](./docs/alerts/storage/robin-disk-inactive-10m-promql-doc.md) |
| `alerts/storage/robin-master-down-10m.yaml` | Yes | `conditionMonitoringQueryLanguage` used. | WIP | [mql2promql/alerts-promql/storage/robin-master-down-10m-promql.yaml](./alerts-promql/storage/robin-master-down-10m-promql.yaml) | [mql2promql/docs/alerts/storage/robin-master-down-10m-promql-doc.md](./docs/alerts/storage/robin-master-down-10m-promql-doc.md) |
| `alerts/storage/robin-node-offline-30m.json` | Yes | JSON format, uses `conditionThreshold` with MQL-like filter. | WIP | [mql2promql/alerts-promql/storage/robin-node-offline-30m-promql.yaml](./alerts-promql/storage/robin-node-offline-30m-promql.yaml) | [mql2promql/docs/alerts/storage/robin-node-offline-30m-promql-doc.md](./docs/alerts/storage/robin-node-offline-30m-promql-doc.md) |
| `alerts/system/configsync-down-30m.yaml` | Yes | `conditionAbsent` used. The new alert is more granular, firing if all ConfigSync metrics within a single cluster disappear. | To be verified | [mql2promql/alerts-promql/system/configsync-down-30m-promql.yaml](./alerts-promql/system/configsync-down-30m-promql.yaml) | [mql2promql/docs/alerts/system/configsync-down-30m-promql-doc.md](./docs/alerts/system/configsync-down-30m-promql-doc.md) |
| `alerts/system/configsync-high-apply-duration-1h.yaml` | No | Uses `conditionPrometheusQueryLanguage`. | N/A | N/A | N/A |
| `alerts/system/configsync-old-last-sync-2h.yaml`                                                         | Yes           | `conditionMonitoringQueryLanguage` used.                              | TBD               | TBD                                                                                                                                                                        |                                                                                                                          |
| `alerts/system/coredns-down.yaml`                                                                        | Yes           | `conditionMonitoringQueryLanguage` used.                              | TBD               | TBD                                                                                                                                                                        |                                                                                                                          |
| `alerts/system/coredns-servfail-ratio-1-percent.yaml`                                                    | Yes           | `conditionMonitoringQueryLanguage` used.                              | TBD               | TBD                                                                                                                                                                        |                                                                                                                          |
| `alerts/system/externalsecrets-down-30m.yaml`                                                            | Yes           | `conditionMonitoringQueryLanguage` used.                              | TBD               | TBD                                                                                                                                                                        |                                                                                                                          |
| `alerts/system/externalsecrets-sync-error.yaml`                                                          | No            | Uses `conditionPrometheusQueryLanguage`.                              | N/A               | N/A                                                                                                                                                                        |                                                                                                                          |
| `alerts/vm-workload/vmruntime-heartbeats-active-realtime.yaml`                                           | Yes           | `conditionMonitoringQueryLanguage` used.                              | TBD               | TBD                                                                                                                                                                        |                                                                                                                          |
| `alerts/vm-workload/vmruntime-heartbeats-realtime.yaml`                                                  | Yes           | `conditionMonitoringQueryLanguage` used.                              | TBD               | TBD                                                                                                                                                                        |                                                                                                                          |
| `alerts/vm-workload/vmruntime-vm-down-5m.yaml`                                                           | Yes           | `conditionMonitoringQueryLanguage` used.                              | TBD               | TBD                                                                                                                                                                        |                                                                                                                          |
| `alerts/vm-workload/vmruntime-vm-missing-5m.yaml`                                                        | Yes           | `conditionMonitoringQueryLanguage` used.                              | TBD               | TBD                                                                                                                                                                        |                                                                                                                          |
| `alerts/vm-workload/vmruntime-vm-no-network-traffic-5m.yaml`                                             | Yes           | `conditionMonitoringQueryLanguage` used.                              | TBD               | TBD                                                                                                                                                                        |                                                                                                                          |

### Glossary of Conversion Status

- **N/A**: Not Applicable. The file does not contain any MQL queries that require conversion.
- **TBD**: To Be Done. The file contains MQL queries, but the conversion has not been started yet.
- **WIP**: Work In Progress. The conversion for this file is currently in progress.
- **To be verified**: The conversion has been completed, but it is pending review and verification.
- **Completed**: The conversion has been completed and verified.

---

## Deployment of Converted Dashboards and Alerts

To deploy the converted dashboards and alerts, you can use the provided shell scripts.

### Dashboards

To deploy the PromQL only [dashboards](./dashboards-promql/), run the following command from the `mql2promql/dashboards-promql` directory:

```bash
./create-dashboards-promql.sh
```

### Alerts

To deploy the PromQL only [alerts](./alerts-promql/), run the following command from the `mql2promql/alerts-promql` directory:

```bash
./create-alerts-promql.sh
```
