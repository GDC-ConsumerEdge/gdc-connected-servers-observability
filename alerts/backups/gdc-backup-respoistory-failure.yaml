combiner: OR
conditions:
- conditionMonitoringQueryLanguage:
    duration: 300s
    query: |-
      fetch k8s_container
      | metric 'kubernetes.io/anthos/gdc_backup_backup_repositories_attached'
      | filter(metric.importStatus=="FAILURE")
      | group_by 1m,
          [value_gdc_backup_backup_repositories_attached_mean:
            mean(value.gdc_backup_backup_repositories_attached)]
      | every 1m
      | group_by [resource.cluster_name, metric.repoName, metric.importStatus],
          [value_gdc_backup_backup_repositories_attached_mean_aggregate:
            aggregate(value_gdc_backup_backup_repositories_attached_mean)]
      | condition val() < 1 '1'
    trigger:
      percent: 50
  displayName:  GDC Backup Repository Failure
displayName: GDC Backup Repository Failure (warning)
